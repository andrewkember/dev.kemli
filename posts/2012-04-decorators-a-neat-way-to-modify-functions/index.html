<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Decorators: A neat way to modify functions | Andrew Kember</title><meta name=keywords content><meta name=description content="In Python, decorators are a construction that help reduce boilerplate code, enhance the maintainability of our code and address the separation of concerns. A decorator is a statement just above the function it decorates. Here&rsquo;s a simple example so you can understand what I mean:"><meta name=author content="AK"><link rel=canonical href=https://blog.kember.net/posts/2012-04-decorators-a-neat-way-to-modify-functions/><link crossorigin=anonymous href=/assets/css/stylesheet.min.c88963fe2d79462000fd0fb1b3737783c32855d340583e4523343f8735c787f0.css integrity="sha256-yIlj/i15RiAA/Q+xs3N3g8MoVdNAWD5FIzQ/hzXHh/A=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.min.b95bacdc39e37a332a9f883b1e78be4abc1fdca2bc1f2641f55e3cd3dabd4d61.js integrity="sha256-uVus3DnjejMqn4g7Hni+Srwf3KK8HyZB9V4809q9TWE=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://blog.kember.net/static/images-header/ak-logo-2021-black-filled-optimised.svg><link rel=icon type=image/png sizes=16x16 href=https://blog.kember.net/static/images-header/ak-logo-2021-black-filled-optimised.svg><link rel=icon type=image/png sizes=32x32 href=https://blog.kember.net/static/images-header/ak-logo-2021-black-filled-optimised.svg><link rel=apple-touch-icon href=https://blog.kember.net/static/images-header/ak-logo-2021-black-filled-optimised.svg><link rel=mask-icon href=https://blog.kember.net/static/images-header/ak-logo-2021-black-filled-optimised.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.112.7"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Decorators: A neat way to modify functions"><meta property="og:description" content="In Python, decorators are a construction that help reduce boilerplate code, enhance the maintainability of our code and address the separation of concerns. A decorator is a statement just above the function it decorates. Here&rsquo;s a simple example so you can understand what I mean:"><meta property="og:type" content="article"><meta property="og:url" content="https://blog.kember.net/posts/2012-04-decorators-a-neat-way-to-modify-functions/"><meta property="og:image" content="https://blog.kember.net/static/images-header/ak-logo-2021-black-filled-optimised.svg"><meta property="article:section" content="posts"><meta property="article:published_time" content="2012-04-03T19:28:08+00:00"><meta property="article:modified_time" content="2012-04-03T19:28:08+00:00"><meta property="og:site_name" content="Andrew Kember"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://blog.kember.net/static/images-header/ak-logo-2021-black-filled-optimised.svg"><meta name=twitter:title content="Decorators: A neat way to modify functions"><meta name=twitter:description content="In Python, decorators are a construction that help reduce boilerplate code, enhance the maintainability of our code and address the separation of concerns. A decorator is a statement just above the function it decorates. Here&rsquo;s a simple example so you can understand what I mean:"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://blog.kember.net/posts/"},{"@type":"ListItem","position":2,"name":"Decorators: A neat way to modify functions","item":"https://blog.kember.net/posts/2012-04-decorators-a-neat-way-to-modify-functions/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Decorators: A neat way to modify functions","name":"Decorators: A neat way to modify functions","description":"In Python, decorators are a construction that help reduce boilerplate code, enhance the maintainability of our code and address the separation of concerns. A decorator is a statement just above the function it decorates. Here\u0026rsquo;s a simple example so you can understand what I mean:\n","keywords":[],"articleBody":"In Python, decorators are a construction that help reduce boilerplate code, enhance the maintainability of our code and address the separation of concerns. A decorator is a statement just above the function it decorates. Here’s a simple example so you can understand what I mean:\ndef heading1(func): \"\"\" Define the decorating function - this wraps the return value of the string in html heading tags. Don't actually write html like this - it is a silly idea. \"\"\" def wrapper(*args, **kwargs): return \"\" + func(*args, **kwargs) + \"\" return wrapper # Use the decorator here, before the function definition. @heading1 def subject(): return \"Decorators: A neat way to modify functions\" print subject() # Output is \"Decorators: A neat way to modify functions\" That seems very neat, but this is a simple way of writing something complicated, so there are some kinks to iron out. The first is that in a generally applicable decorator, the decorating function must be able to accept an arbitrary argument list (meaning any arrangement of arguments and keyword arguments). The issue with this is that the resulting decorated function takes on the signature of the decorating function, so introspection of the function tells you that it accepts all positional and keyword arguments (*args, **kwargs).\nThe second problem is that the decorating function does not have the same attributes as the decorated function. E.g. __name__, __doc__, __module__, __dict__ and in Python 3, __annotations__.\nThe solution to these problems is provided in the form of the decorator package. This does all the leg-work of copying attributes as well as making signature-preserving decorators. As an added bonus, it removes the need to nest the wrapper function.\nHere is the same trivial example, written using the decorator module:\nimport decorator @decorator.decorator def heading1(func, *args, **kwargs): \"\"\"This was the wrapper function for the decorator. It now takes the caller function as the first argument. The defining of the decorator itself is handled by... the decorator! \"\"\" return \"\" + func(*args, **kwargs) + \"\" # Use the decorator here, before the function definition. @heading1 def subject(): return \"Decorators: A neat way to modify functions\" print subject() # Output is \"Decorators: A neat way to modify functions\" There are plenty more resources for managing and learning about decorators. If you want to avoid installing the decorators package, you can do some of the hard work with functools.wraps. There’s more about the decorators package and some good examples in the package documentation. StackOverflow is always a good place to look for examples (good and bad). The Python docs have a page full of decorator examples.\nThanks to saurik over on Hacker News for pointing out that I should really be using decorator.decorator as a decorator.\n","wordCount":"451","inLanguage":"en","datePublished":"2012-04-03T19:28:08Z","dateModified":"2012-04-03T19:28:08Z","author":{"@type":"Person","name":"AK"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.kember.net/posts/2012-04-decorators-a-neat-way-to-modify-functions/"},"publisher":{"@type":"Organization","name":"Andrew Kember","logo":{"@type":"ImageObject","url":"https://blog.kember.net/static/images-header/ak-logo-2021-black-filled-optimised.svg"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://blog.kember.net/ accesskey=h title="Andrew Kember (Alt + H)"><svg xmlns="http://www.w3.org/2000/svg" width="55" height="55" viewBox="0 0 202.02 202.02" style="vertical-align:middle"><g transform="translate(-3.65 -3.93)"><circle style="opacity:1;fill:none;fill-opacity:1;stroke:currentColor;stroke-width:16;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" cx="104.66" cy="104.94" r="93.01"/></g><g style="display:inline;fill:currentColor;fill-opacity:1;stroke:none"><path d="m242.73 334.58 28.99-2.5-.77 48q-.19 4.8.2 8.45.38 3.26 1.15 5.76.76 2.5 2.5 2.5 1.53.0 2.49-1.93 1.15-2.1 1.73-4.6.76-2.88.96-6.72h8.25q.58 2.68.58 5.95.0 2.69-.58 6.53-.57 3.84-2.5 8.25-1.53 4.61-3.83 7.68-2.12 3.07-4.8 5-2.5 1.91-5.19 2.87t-5.18 1.54q-2.69.38-6.91-1.34-4.04-1.73-8.07-4.04-4.8-2.68-9.98-6.14-4.42 2.88-7.87 5.18-3.08 2.12-6.15 4.04-2.88 1.92-4.03 2.3-.96.38-4.42 1.34-3.45.96-8.44.77-5 0-11.14-2.3-6.14-2.11-12.29-8.07-6.33-6.14-9.02-13.24-2.69-7.3-3.65-13.44-.96-7.3.0-14.4.38-8.26 2.69-15.94 2.11-6.53 6.33-13.44 4.42-6.91 12.48-11.33 8.07-4.41 15.94-3.84 8.06.39 14.4 2.5 7.49 2.5 14.4 7.3zm-19.01 12.28q-5.57.0-9.4 6.15-3.85 6.14-3.85 18.24.0 12.48 3.84 19.2 3.84 6.72 9.41 6.72t9.8-6.72q4.22-6.72 4.22-19.2.0-12.1-4.23-18.24-4.22-6.15-9.79-6.15z" style="font-size:192px" transform="translate(-82.94 -145.69) scale(.6706)" aria-label="a"/><path d="M217.2 420.6h-42.63v-16.14q3.84.2 6.72-.57 2.5-.77 4.41-2.69 2.12-2.11 1.73-6.34v-19.39q.2-6.91.2-14.78.19-8.07.19-16.13.19-18.82.38-41.28l29-12.1v74.12q2.87.19 5.75-.2 2.5-.38 5-.96 2.49-.57 4.41-2.1 3.07-3.08 1.92-6.34-1.15-3.46-8.26-3.46l.77-11.14 43.2-.96q1.73 10.37.77 18.82-.38 3.65-1.54 7.1-.96 3.46-2.88 6.34t-4.99 4.8-7.3 2.3l29 40.13-38.6.96-19.39-23.23q-2.3-1.54-4.03-1.92-1.53-.38-2.69.38-1.15.77-1.15 3.84z" style="font-size:192px" transform="translate(-21.52 -145.16) scale(.6706)" aria-label="k"/></g></svg></a></div><ul id=menu><li><a href=https://blog.kember.net/about/ title=About><span>About</span></a></li><li><a href=https://blog.kember.net/commonplace/ title=Commonplace><span>Commonplace</span></a></li><li><a href=https://blog.kember.net/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><span class=logo-switches>&nbsp;|
<button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://blog.kember.net/>Home</a>&nbsp;»&nbsp;<a href=https://blog.kember.net/posts/>Posts</a></div><h1 class=post-title>Decorators: A neat way to modify functions</h1><div class=post-meta><span title='2012-04-03 19:28:08 +0000 UTC'>April 3, 2012</span>&nbsp;·&nbsp;AK</div></header><div class=post-content><p>In Python, decorators are a construction that help reduce boilerplate code, enhance the maintainability of our code and address the separation of concerns. A decorator is a statement just above the function it decorates. Here&rsquo;s a simple example so you can understand what I mean:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>heading1</span>(func):
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;&#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    Define the decorating function - this wraps the return value of the 
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    string in html heading tags. Don&#39;t actually write html like this - it is a
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    silly idea.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    &#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>wrapper</span>(<span style=color:#f92672>*</span>args, <span style=color:#f92672>**</span>kwargs):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#34;&lt;h1&gt;&#34;</span> <span style=color:#f92672>+</span> func(<span style=color:#f92672>*</span>args, <span style=color:#f92672>**</span>kwargs) <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;&lt;/h1&gt;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> wrapper
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Use the decorator here, before the function definition.</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@heading1</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>subject</span>():
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#34;Decorators: A neat way to modify functions&#34;</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>print subject()
</span></span><span style=display:flex><span><span style=color:#75715e># Output is &#34;&lt;h1&gt;Decorators: A neat way to modify functions&lt;/h1&gt;&#34;</span>
</span></span></code></pre></div><p>That seems very neat, but this is a simple way of writing something complicated, so there are some kinks to iron out. The first is that in a generally applicable decorator, the decorating function must be able to accept an arbitrary argument list (meaning any arrangement of arguments and keyword arguments). The issue with this is that the resulting decorated function takes on the signature of the decorating function, so introspection of the function tells you that it accepts all positional and keyword arguments (<code>*args, **kwargs</code>).</p><p>The second problem is that the decorating function does not have the same attributes as the decorated function. E.g. <code>__name__</code>, <code>__doc__</code>, <code>__module__</code>, <code>__dict__</code> and in Python 3, <code>__annotations__</code>.</p><p>The solution to these problems is provided in the form of the <a href=http://pypi.python.org/pypi/decorator/>decorator</a> package. This does all the leg-work of copying attributes as well as making signature-preserving decorators. As an added bonus, it removes the need to nest the wrapper function.</p><p>Here is the same trivial example, written using the <code>decorator</code> module:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> decorator
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@decorator.decorator</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>heading1</span>(func, <span style=color:#f92672>*</span>args, <span style=color:#f92672>**</span>kwargs):
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;&#34;&#34;This was the wrapper function for the decorator. It now takes the 
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    caller function as the first argument. The defining of the decorator 
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    itself is handled by... the decorator!
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    &#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#34;&lt;h1&gt;&#34;</span> <span style=color:#f92672>+</span> func(<span style=color:#f92672>*</span>args, <span style=color:#f92672>**</span>kwargs) <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;&lt;/h1&gt;&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Use the decorator here, before the function definition.</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@heading1</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>subject</span>():
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#34;Decorators: A neat way to modify functions&#34;</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>print subject()
</span></span><span style=display:flex><span><span style=color:#75715e># Output is &#34;&lt;h1&gt;Decorators: A neat way to modify functions&lt;/h1&gt;&#34;</span>
</span></span></code></pre></div><p>There are plenty more resources for managing and learning about decorators. If you want to avoid installing the decorators package, you can do some of the hard work with <a href="http://docs.python.org/py3k/library/functools.html?highlight=functools#functools.wraps">functools.wraps</a>. There&rsquo;s more about the decorators package and some good examples in the <a href=https://micheles.googlecode.com/hg/decorator/documentation3.html>package documentation</a>. <a href="http://stackoverflow.com/search?q=%5Bpython%5D+decorators">StackOverflow</a> is always a good place to look for examples (good and bad). The Python docs have a page full of <a href=http://wiki.python.org/moin/PythonDecoratorLibrary>decorator examples</a>.</p><p>Thanks to saurik over on <a href="https://news.ycombinator.com/item?id=3794443">Hacker News</a> for pointing out that I should really be using <code>decorator.decorator</code> as a decorator.</p></div><footer class=post-footer><nav class=paginav><a class=prev href=https://blog.kember.net/posts/2013-08-on-the-extinguishing-of-urls/><span class=title>« Prev Page</span><br><span>On The Extinguishing Of URLs</span></a>
<a class=next href=https://blog.kember.net/posts/2012-03-ubuntu-home-server-notifications-by-email/><span class=title>Next Page »</span><br><span>Ubuntu home server: Notifications by email</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://blog.kember.net/>Andrew Kember</a></span>
<span>&mdash; Obfuscation is Easy</span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerText="copy";function s(){t.innerText="copied!",setTimeout(()=>{t.innerText="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>